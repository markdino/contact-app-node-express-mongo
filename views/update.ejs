<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Access your friends contact info anywhere" />
  <meta name="robots" content="index, follow" />
  <meta name="author" content="Mark Dino Pelonia" />
  <title>Update | Contact Manager</title>
  <link rel="stylesheet" href="/style.css" />
</head>

<body>
  <main class="container">
    <!-- Contact Thumbnail -->
    <section class="thumbnail-details">
      <section class="buttons">
        <a href="/contact" id="cancel-btn">
          <p>Cancel</p>
        </a>
        <a id="save-btn" onclick="document.querySelector('#submit-btn').click()">
          <p>Save</p>
        </a>
      </section>

      <a onclick="showModal()">
        <section id="add-photo" class="row">
          <svg viewBox="0 0 512 512" class="camera-svg">
            <path
              d="M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z" />
          </svg>
        </section>
      </a>
    </section>
    <section class="thumbnail-holder">
      <img src="<%= person.avatar || `/user.svg` %>" alt="profile avatar" id="img-avatar" />
    </section>
    <!-- Image Modal -->
    <section id="img-modal" class="d-none">
      <section class="row align-item-center modal-wrapper">
        <section class="modal-container">
          <section class="input-group">
            <label for="img-link">Image link</label>
            <input type="text" id="img-link" placeholder="https://"
              value="<%= person.avatar !== '/user.svg' ? person.avatar : '' %>" />
          </section>
          <section class="buttons">
            <button onclick="hideModal()">Cancel</button>
            <button onclick="getImage(hideModal)">Accept</button>
          </section>
        </section>
      </section>
    </section>
    <!-- Contact Details -->
    <main class="p-10">
      <form action="/contact/<%= person._id %>/update" method="post">
        <input type="text" name="avatar" id="avatar" class="d-none" value="<%= person.avatar %>" />
        <section class="input-group row">
          <% if (person.private === true) { %>
          <input type="checkbox" id="private" name="private" checked />
          <% }else{ %>
          <input type="checkbox" id="private" name="private" />
          <% } %>
          <label for="private">Private</label>
        </section>
        <section class="input-group">
          <label for="name">Name</label>
          <input type="text" id="name" name="name" value="<%= person.name %>" required />
        </section>
        <section class="input-group">
          <label for="mobile">Mobile</label>
          <input type="tel" name="mobile" id="mobile" value="<%= person.mobile || `` %>" />
        </section>
        <section class="input-group">
          <label for="tel">Tel.</label>
          <input type="tel" name="tel" id="tel" value="<%= person.tel || `` %>" />
        </section>
        <section class="input-group">
          <label for="email">Email</label>
          <input type="email" name="email" id="email" value="<%= person.email || `` %>" />
        </section>
        <section class="input-group">
          <label for="address">Address</label>
          <input type="text" name="address" id="address" value="<%= person.address || `` %>" />
        </section>
        <button type="submit" id="submit-btn" class="d-none"></button>
      </form>
    </main>
  </main>
  <script>
    const imgModal = document.querySelector("#img-modal");
    const imgLink = document.querySelector("#img-link");
    const avatarField = document.querySelector("#avatar");
    const avatarImg = document.querySelector("#img-avatar");

    function getImage(callback) {
      let img = imgLink.value;
      if (imgLink.value.length <= 0) img = "/user.svg";

      avatarField.value = img;
      avatarImg.src = img;
      callback();
    }
    function showModal() {
      imgModal.classList.remove("d-none");
      imgLink.focus();
    }
    function hideModal() {
      imgModal.classList = "d-none";
    }
  </script>
</body>

</html>